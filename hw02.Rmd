---
title: "Video Game Habits Among UC Berkeley Statistics Students"
output: pdf_document
date: "2024-10-21"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
video_data <- read.table("videodata.txt", header = TRUE, sep="")
video_multiple <- read.table("videoMultiple.txt", header = TRUE, sep="")
```

## Contribution

Students 1 and 2 were responsible for the conclusion and analysis parts 1, 2, and 3. Student 1 completed the advanced analysis. Student 2 completed the introduction and analysis parts 4, 5, and 6.

# 1. Introduction

This report analyzes a survey conducted among 3000 - 4000 students enrolled in statistics courses at UC Berkeley during the Fall 1994 semester. The survey aimed to investigate students' video game habits, preferences, and attitudes towards gaming. A total of 314 students from Statistics 2, Section 1 were eligible for the survey based on their participation in the second exam of the semester, with 95 students randomly selected to participate. Out of the selected group, 91 students submitted complete responses, with incomplete responses encoded as 99.

The survey covered questions including the number of hours spent playing video games, where and how often students play, their preferences for different types of games, etc. The second part of the survey covered students' attitudes toward video games, whether they liked playing games or not and why.

The primary goal of this analysis is to investigate students' video game behaviors and preferences, as well as potential correlations between these behaviors and demographic factors such as gender, work, and computer ownership. Specifically, we aim to investigate the proportion of students playing video games during the week prior to the survey, the relation between reported time spend playing video games, the frequency of playing, and timing of the survey, the main reasons students like or dislike playing video games, and any noticeable differences in video game preferences and habits based on demographics. We found that approximately 37% of students played video games in the week before the survey, and on average, students who played spent 1.24 hours gaming. Overall, video games are popular, with 76% of respondents expressing enjoyment, primarily for relaxation and mastery, while time constraints were the main reason for disliking them. While gender and work status did not significantly impact gaming enjoyment, students with computer access were much more likely to enjoy video games. The "Play If Busy" variable was found to be a possible confounder in our estimations of weekly gameplay, though liking math didn't seem to have any correlation with gaming time.

The report is structured as follows: Section 1 introduces this study's objectives, background, and key questions, Section 2 analyzes the survey data, including numerical and graphical comparisons of video game habits and preferences. Section 3 exploring additional factors, such as students' attitudes toward gaming, and includes an advanced analysis of variables that may influence time spent on gaming. Section 4 summarizes the findings and discusses possible limitations.

# 2. Analysis

## 2.1 Estimate Proportions of Students Who Played a Video Game

### 2.1.1 Methods

The first step of our analysis was to estimate the proportion of students who played a video in the week prior to the survey. We found both a point estimate and an interval estimate for this proportion.

The point estimate represents a single estimated value of the proportion of students who played video games based on the sample. The sample proportion $\bar{X}$ is calculated as the ratio of students who played video games (i.e., reported playing for more than 0 hours) to the total number of students surveyed.

The formula for the sample proportion is given by: $$
   \bar{X} = \frac{k}{n}
   $$ where $k$ is the number of students who played video games, and $n$ is the total number of students surveyed.

The interval estimate provides a range that is likely to contain the true proportion of students who played video games. This is calculated using a \*\*confidence interval with a 95% confidence interval.

The confidence interval is calculated as: $$
   (\bar{X} - 2 \frac{s}{\sqrt{n}}, \bar{X} + 2 \frac{s}{\sqrt{n}})
   $$ where $\frac{s}{\sqrt{n}}$ is the standard error; $s$ is the sample standard deviation.

### 2.1.2 Analysis

To find the point estimate, we found the sample proportion by counting the number of students whose playing time a week prior to the survey was greater than zero and the total number of responses to the survey. The proportion of students who played video games in the week prior to the survey is approximately 37.36%. While the point estimate gives a specific value, it does not account for the inherent variability that comes with sampling. To take this uncertainty into account, we calculated a 95% confidence interval. The 95% confidence interval for the proportion of students who played video games is between 27.22% and 47.51%.

### 2.1.3 Conclusion

A point estimator is a single value $\bar{x}$, useful for summarizing the central tendency. In this case, it estimates the proportion of students that played video games a week prior to the survey given a sample. An interval estimate is a range of two values, where one can estimate that the population proportion is between those two values with a fixed confidence (probability), reflecting the variability in the sample data. The interval is based on the assumption that our sample is representative of the entire population of students who took the survey. The confidence interval ensures that if the survey were repeated multiple times, 95% of the intervals calculated in this manner would contain the true population proportion. In our case, the interval estimate is very wide, reducing its usefulness in estimating the population proportion, since the true proportion could plausibly fall anywhere between 27% and 47%.

## 2.2 Comparison of Time Spent and Reported Frequency of Playing Video Games

### 2.2.1 Methods

Next, we wanted to look at the if the amount of time spent playing games in the week prior to the survey compares for different reported frequencies. In the survey, students were asked to report how often they play video games on a scale from 1-4, where 1 represents playing daily, 2 represents playing weekly, 3 represents playing monthly, and 4 represents playing semesterly. To compare the amount of time spent playing games between different reported frequencies, we graphed the distributions of time spent playing games and calculated the proportion of students who reported playing video games in each frequency category and the average time they spent playing. This comparison helped us assess whether students' reported gaming habits align with the actual hours they spent playing video games. We considered the potential impact of an exam held the week before the survey, which may have influenced the amount of time students spent playing video games that week.

### 2.2.2 Analysis
```{r, echo=FALSE, fig.width=3.5, fig.height=2.5}
daily_gamers <- video_data[video_data$freq == 1,]
weekly_gamers <- video_data[video_data$freq == 2,]
monthly_gamers <- video_data[video_data$freq == 3,]
semesterly_gamers <- video_data[video_data$freq == 4,]

hist(daily_gamers$time, 
     main = "Daily Gamers", 
     xlab = "Hours Played",
     breaks=20)
hist(weekly_gamers$time, 
     main = "Weekly Gamers", 
     xlab = "Hours Played",
     breaks=20)
```

```{r, echo=FALSE, fig.width=3.5, fig.height=2.5}
hist(monthly_gamers$time, 
     main = "Monthly Gamers", 
     xlab = "Hours Played",
     breaks=20)
hist(semesterly_gamers$time, 
     main = "Semesterly Gamers", 
     xlab = "Hours Played",
     breaks=20)
```

Based on these graphs, it becomes apparent that daily and weekly gamers spent a lot more time playing games a week prior to this survey compared to monthly and semesterly gamers.

```{r, echo=FALSE}
library(knitr)
library(kableExtra)

numerical_summaries <- data.frame(
  Proportions = c('77.78%', '85.71%', '11.11%', '4.35%')
)

rownames(numerical_summaries) <- c("Daily", "Weekly", "Monthly", "Semesterly")

kable(numerical_summaries, caption = "Sample Reported Frequency") %>%
  kable_styling(latex_options = c("striped", "hold_position"), full_width = FALSE)
```

Similarly, the numerical summaries show that more daily and weekly gamers spent time playing games the week prior to the survey than monthly and semesterly gamers.

### 2.2.3 Conclusion

This survey was taken a week after a statistics exam, and the participants were students who participated in that exam. The fact that there was an exam in the week prior to the survey could possibly affect the previous estimates and this comparison. Students who reported playing daily or weekly generally followed through with significant gaming time during the week prior to the survey, seen by their higher point estimates and the shape of their time distributions. This suggests a strong alignment between reported gaming habits and actual behavior for these groups. On the otherhand, the majority of students who reported playing monthly or semesterly did not play video games during the week prior to the survey. Their self-reported frequency of playing (monthly or semesterly) may correctly reflect their long-term habits, however the timing of the survey (after the exam) may have influenced their decision not to play games during that specific week, which could explain the low percentages of gameplay in those groups. This could also explain why the overall proportion of students who played games in the past week was lower than expected. 

Other variables in the survey like "Hate Math", "Grade Expected", or "Play if Busy" may be confounding variables that affect the results of our estimation. For example, those that respond "Yes" to the question "Hate Math" may dedicate less time to studying and more time to playing games. Similarly, those that already have high expectations for what grade they would earn on the upcoming exam might spend less time studying and more time playing games. Those that respond "Yes" to "Play if Busy" may still decide to spend time playing games despite being busy studying for the exam.

## 2.3 Point and Interval Estimate for Average Time Spent Playing Video Games

### 2.3.1 Methods

To estimate the average time spent playing video games during the week prior to the survey, we will calculate both a point estimate and a 95% confidence interval for the mean.

The point estimate for the average time is the sample mean of the time spent playing video games, excluding those who reported zero hours of gameplay. The formula for the sample mean $\bar{X}$ is: $$
   \bar{X} = \frac{1}{n} \sum_{i=1}^{n} X_i
   $$ where $X_i$ is the number of hours played by the $i$th student and $n$ is the total number of students in the sample.

We explored the shape of the data using a histogram to visualize the distribution of the reported time spent. Given that the data appeared heavily skewed, we chose to use bootstrapping, a resampling method, to estimate a 95% confidence interval for the mean. Since the sample distribution is not normal, bootstrapping is useful becuase it does not require the assumption of normality.

The procedure for bootstrapping involved resampling the data (with replacement) 10,000 times and calculating the mean for each resample. This allowed us to generate a distribution of means and compute the point estimate (the sample mean) and the 95% confidence interval using the 2.5th and 97.5th percentiles of the bootstrap distribution.

### 2.3.2 Analysis

The point estimate for the average amount of time spent playing video games is 1.24 hours. To account for the right-skewed distribution, we generated a 95% confidence interval through bootstrapping. The resulting interval ranges from 0.60 hours to 2.11 hours.

The histogram of the bootstrap distribution, shown below, shows an approximately normal sampling distribution of the mean, despite the skewness of the original data due to the large sampling size (CLT), suggesting the bootstrap method was appropriate for generating the interval estimate. The red dashed line in the histogram represents the point estimate, while the blue dashed lines represent the boundaries of the 95% confidence interval.

```{r, echo=FALSE, fig.height=4, fig.width=7}

#Look at the shape of the data
hist(video_data$time,
     main = 'Time Spent Playing Games',
     xlab = "Hours Played",
     breaks=20)

#Use bootstrapping to calculate the confidence interval since the data is heavily skewed.
point_estimate_average <- mean(video_data$time) #1.242857
n_size<- dim(video_data)[1]
n_iterations <- 10000

bootstrap_means <- numeric(n_iterations)

set.seed(123)
for (i in 1:n_iterations) {
  bootstrap_sample <- sample(video_data$time, size = n_size, replace = TRUE)
  bootstrap_means[i] <- mean(bootstrap_sample)
}

lower_interval_estimate_average <- quantile(bootstrap_means, 0.025) #0.5988462  
upper_interval_estimate_average <- quantile(bootstrap_means, 0.975) #2.11217

hist(bootstrap_means, breaks = 30, col = "lightblue", main = "Bootstrap Distribution of the Mean", 
     xlab = "Mean", ylab = "Frequency")

abline(v = point_estimate_average, col = 'red', lty = 2, lwd = 2)
abline(v = lower_interval_estimate_average, col = "blue", lty = 2, lwd = 2)
abline(v = upper_interval_estimate_average, col = "blue", lty = 2, lwd = 2)

```

### 2.3.3 Conclusions

The average amount of time students spent playing video games in the week prior to the survey is estimated to be 1.24 hours. The 95% confidence interval suggests that, on average, students spent between 0.60 and 2.11 hours playing video games during that week. This interval accounts for the skewed nature of the data and provides a more robust estimate than taking two standard errors away from the mean, due to the non-normality of the distribution.

The simulation study supports the validity of boostrapping to determine the interval estimate, as the bootstrap distribution of the mean follows a roughly normal shape, proving to be an effective way to estimate the average time spent on video games in this dataset.

To conclude, we estimate that students who played video games spent an average of about 1.24 hours playing games in the week prior to the survey, with the true mean likely falling between 1.48 and 2.46 hours.

## 2.4 Attitude Toward Video Games

### 2.4.1 Methods

To analyze the students' attitudes towards video games, we will focus on the responses to the questions assessing how much students like playing video games, the reasons for playing, and the reasons for disliking them.

The variable 'play' in the dataset categorizes students' preferences for video games as follows: 1 = never played, 2 = very much, 3 = somewhat, 4 = not really, and 5 = not at all.

We will assess whether students generally enjoy playing video games by analyzing the distribution of responses. We will examine the reasons why students like or dislike video games by focusing on the most frequently mentioned reasons.

Since some students were asked to skip certain questions (e.g., those who never played video games), we will account for nonresponses when interpreting the results. This includes the proportion of nonrespondents for questions such as whether video games are educational and where they play.

We will create two lists based on the most frequently selected responses for reasons why students like or dislike video games: Reasons for Liking Video Games; Reasons for Disliking Video Games.

### 2.4.2 Analysis
```{r, echo=FALSE, fig.width=5, fig.height=3, fig.align='center'}
filtered_video_data <- video_data[video_data$like != 99, ]

# Plot a histogram of video game preferences
hist(filtered_video_data$like, 
     breaks = 5,
     main = "Distribution of Video Game Preferences", 
     xlab = "Preference (1 = Never Played, 2-3 = Enjoys, 4-5 = Dislikes)",
     ylab = "Frequency",
     xaxt = "n")

axis(1, at = 1:5, labels = c("Never Played", "Enjoy (2)", "Enjoy (3)", "Dislike (4)", "Dislike (5)"))
```

The distribution of students' preferences for video games using the `play` variable is shown above About 75.82% of students reported that they enjoy video games (combining responses for "like" values 2 and 3). 21.98% of students reported that they dislike video games (responses for "like" values 4 and 5). Only 1.10% of students reported that they have never played video games.

```{r, echo=FALSE}
library(knitr)
library(kableExtra)

# Create the data frame for proportions
proportions_data <- data.frame(
  Proportion = c('75.82%', '21.98%', '1.10%')
)

# Set the row names
rownames(proportions_data) <- c("Enjoys Video Games", "Dislikes Video Games", "Never Played Video Games")

# Use kable to create the table with styling
kable(proportions_data, caption = "Proportion of Students' Preferences for Video Games") %>%
  kable_styling(latex_options = c("striped", "hold_position"), full_width = FALSE)
```

Next, we examined the most common reasons for liking or disliking video games from the second part of the survey.

```{r, echo=FALSE, fig.height = 4}
par(mfrow = c(1, 2), mar = c(5, 4, 4, 2) + 0.1, cex = 0.7)

reasons_liking <- colSums(video_multiple[, c("graphic", "relax", "coord", 
                                             "challenge", "master", "bored")], na.rm = TRUE)

reasons_disliking <- colSums(video_multiple[, c("time", "frust", "lonely", "rules", "cost", "boring", "friends", "point")], na.rm = TRUE)


reasons_for_likeliness <- list(
  "Reasons for Liking" = names(sort(reasons_liking, decreasing = TRUE)[1:4]),
  "Reasons for Disliking" = names(sort(reasons_disliking, decreasing = TRUE)[1:4])
)

barplot(reasons_liking, 
        main = "Reasons for Liking Video Games", 
        xlab = "Reason", 
        ylab = "Count",
        las = 2)

barplot(reasons_disliking, 
        main = "Reasons for Disliking Video Games", 
        xlab = "Reason", 
        ylab = "Count",
        las = 2)

par(mfrow = c(1, 1), cex = 1)

```

### 2.4.3 Conclusion

Based on the analysis of the attitude questions, we find that a majority of students enjoy playing video games to some extent. Approximately 76% of students reported liking video games either very much or somewhat, while about 22% of students reported disliking them or not playing at all. This suggests that video games are generally popular among students, with a significant majority finding enjoyment in them.

#### The most common reasons students provided for liking video games include:

1.  Relaxation - The highest count of students cited relaxation as a reason for liking video games.
2.  Feeling of Mastery - Many students enjoy the sense of accomplishment and mastery over the challenges in video games.
3.  Bored - Some students use video games as a way to relieve boredom.
4.  Graphics/Realism - The quality of graphics and visual appeal was also a common reason for liking video games.

#### The most frequent responses for disliking video games are:

1.  Too much time - The most common reason for disliking video games was the amount of time they consume.
2.  Costs too much - The expense of gaming was a significant deterrent.
3.  It is pointless - Some students view video games as having no real purpose or point.
4.  Frustrating - Certain students found video games frustrating, which reduced their enjoyment.

It is noted that students who have never played video games or expressed strong dislike for them were instructed to skip certain questions, which likely explains the presence of nonrespondents for some of the attitude questions. Consequently, there may be a higher number of non-responses in questions related to other aspects of video games (like whether they are educational or where they play). The analysis of those specific questions would primarily reflect the views of students who already have a positive opinion of video games.

Overall, students generally enjoy playing video games, with relaxation being the most common reason for liking them and time commitment being the most common reason for disliking them.

## 2.5 Differences Between Students Who Like and Dislike Video Games

### 2.5.1 Methods

We will examine the differences between students who enjoy playing video games versus those who don't. We use survey data to examine differences based on three demographic variables:

1.  Gender (Male vs. Female)
2.  Work Status (Students who work for pay vs. those who don’t)
3.  Computer Ownership (Students who own a computer vs. those who don’t)

To simplify these comparisons, we will collapse the responses to video game preference into two main categories:

-   Enjoys Video Games: This includes students who selected "2" (very much) and "3" (somewhat).
-   Dislikes Video Games: This includes students who selected "4" (not really) and "5" (not at all).

The students who selected "1" (never played) will not be included in this analysis. We will compute proportions for each demographic group (e.g. male/female, working/not working, owning a computer/not owning a computer) to observe differences in video game preferences. Graphical displays (i.e. bar plots and cross-tabulations) will be used to visualize the differences between the subgroups to help us understand whether demographic factors like gender, work status, or computer ownership are associated with a preference for video games.

### 2.5.2 Analysis

First, we categorized students based on whether they like to play video games or not:

```{r, echo=FALSE}
library(knitr)
library(kableExtra)

numerical_summaries <- data.frame(
  Frequency = c(69,20), Proportion = c("77.5%", "22.5%")
)

rownames(numerical_summaries) <- c("Likes to Play Video Games", "Does not like to Play Video Games")

kable(numerical_summaries, caption = "Sample Frequency of Video Game Preference") %>%
  kable_styling(latex_options = c("striped", "hold_position"), full_width = FALSE)
```

We compute the proportions of students in each category who enjoy or dislike video games and visualized the results using bar plots:

```{r, echo=FALSE, fig.height = 3}
par(mfrow = c(1, 2), mar = c(5, 4, 4, 2) + 0.1, cex = 0.7)

video_data$likes_games <- ifelse(video_data$like == 2, 3 | video_data$like == 4, 5)

gender_table <- table(video_data$likes_games, video_data$sex)
colnames(gender_table) <- c("Female", "Male")

# Work comparison
work_table <- table(video_data$likes_games, video_data$work > 0)
colnames(work_table) <- c("Doesn't Work", "Works")

# Computer ownership comparison
pc_table <- table(video_data$likes_games, video_data$own)
colnames(pc_table) <- c("No PC", "Owns PC")

# Computer ownership comparison visualization
barplot(pc_table, beside = TRUE, col = c(rgb(1,0,0,0.5), rgb(0,0,1,0.5)),
        main = "Preferences by Computer Ownership",
        xlab = "Computer Ownership", ylab = "Number of Students")

legend("topleft", inset = c(0.05, 0), xpd = TRUE,
       legend = c("Doesn't Like", "Likes to Play"),
       fill = c(rgb(1,0,0,0.5), rgb(0,0,1,0.5)))

# Gender comparison visualization
barplot(gender_table, beside = TRUE, col = c(rgb(1,0,0,0.5), rgb(0,0,1,0.5)),
        main = "Preferences by Gender",
        xlab = "Gender", ylab = "Number of Students")

# Work comparison visualization
barplot(work_table, beside = TRUE, col = c(rgb(1,0,0,0.5), rgb(0,0,1,0.5)),
        main = "Preferences by Work Status",
        xlab = "Work Status", ylab = "Number of Students")

```

```{r, echo=FALSE}
library(knitr)
library(kableExtra)

numerical_summaries <- data.frame(
  Female = c("0.363", "0.055", "0.418"), Male = c("0.385", "0.198", "0.582"), Works = c("0.362", "0.154", "0.516"), Does_Not_Work = c("0.385", "0.099", "0.484"), Owns = c("0.538", "0.198", "0.736"), Does_Not_Own = c("0.209", "0.055", "0.264"), Total = c("0.747","0.253", "1.000")
)

rownames(numerical_summaries) <- c("Likes Video Games", "Doesn't like Video Games", "Total")
colnames(numerical_summaries) <- c("Female", "Male", "Works", "Doesn't Work", "Owns", "Doesn't Own", "Total")

kable(numerical_summaries, caption = "Preferences by Gender, Work Status, Computer Ownership") %>%
  kable_styling(latex_options = c("striped", "hold_position"), full_width = FALSE)
```

From the cross-tabulation and bar chart, we observe that male students are more likely to enjoy playing video games compared to female students. A larger proportion of male students report liking video games than female students. Students who work for pay tend to have a slightly lower preference for video games compared to those who don’t work. Students who own a computer are more likely to enjoy playing video games than those who don’t.

### 2.5.3 Conclusions

There is a no notable gender difference for students who like to play video games, with both male and female students being likely to enjoy video games. This suggests that video games may appeal equally to both genders. However, a greater proportion of males reported disliking video games, potentially due to the types of games commonly played by males.

Similarly to gender, work status does not seem to have a significant effect on whether a student likes to play video games. Students who work for pay are relatively as likely to enjoy video games as those who do not work. However, there is a slightly greater proportion of students who work for pay and dislike video games; this could be due to the time constraints faced by working students, who may have less leisure time.

Computer ownership appears to have a major influence on whether a student likes to play video games or not. Owning a computer appears to be associated with a higher likelihood of enjoying video games. This is intuitive, as access to technology likely facilitates more frequent gaming, and in the reverse case, liking gaming may encourage the purchase for a computer. Out of the students who dislike gaming, there is, however, a larger proportion who own a computer.

This suggests that gender and work status may not be related to students' preferenced for video games, while computer ownership appears closely related. Male students, those who do not work, and students who own computers are more likely to enjoy playing video games compared to their counterparts. However, in the population of those who are more likely to dislike playing video games, male students, those who do work, and those who own a laptop take precedent.

## 2.6 Grade Distributions

### 2.6.1 Methods

To analyze students' grade expectations in the course, we will: 1. Calculate the observed distribution of students' expected grades by determining the proportions of students expecting each grade with the letter assignments: 4 = A, 3 = B, 2 = C, 1 = D, 0 = F, 2. Compare the observed distribution with the course's intended grade distribution (20% A's, 30% B's, 40% C's, and 10% D's or lower), 3. Simulate the effect of nonrespondents as potential failing students to evaluate if this assumption could significantly alter the observed distribution. Non-respondents could represent students who may expect to receive failing grades and, therefore, chose not to participate in the survey or attend discussion sections.

### 2.6.2 Analysis

The observed grade distribution from the survey data shows the following proportions:

```{r, echo=FALSE}
library(knitr)
library(kableExtra)

proportions_data <- data.frame(
  Grade = c("A", "B", "C", "D/F"),
  "Observed" = c(0.34065934, 0.57142857, 0.08791209, NA),
  "With Nonrespondents" = c(0.32631579, 0.54736842, 0.08421053, 0.04210526),
  "Target" = c(0.20, 0.30, 0.40, 0.10)
)

kable(proportions_data, caption = "Comparison of Observed and Target Grade Proportions") %>%
  kable_styling(latex_options = c("striped", "hold_position"), full_width = FALSE)

```

By including the 4 non-respondents in the D/F category, we recalculated the proportions to evaluate how it would change the observed distribution's alignment with the target distribution. The bar plots below compares these observed proportions with the target distribution set by the course. Deviations from the target distribution suggests discrepancies between students' expectations and the course's grading goals.

```{r, echo=FALSE, fig.height=4}
par(mfrow = c(1, 2), mar = c(5, 4, 4, 2) + 0.1, cex = 0.8)

# Bar Graphs
  grades <- c("A", "B", "C", "D/F")
  target_proportion <- c(0.2, 0.3, 0.4, 0.1)
  observed_proportion <- c(0.34065934, 0.57142857, 0.08791209, 0.0)
  observed_proportion_with_nonrespondents <- c(0.32631579, 0.54736842, 0.08421053, 0.04210526)
  
  proportions_with_nonrespondents <- rbind(target_proportion, observed_proportion_with_nonrespondents)
  proportions <- rbind(target_proportion, observed_proportion)
  colors <- c(rgb(1,0,0,0.25), rgb(0,0,1,0.25))
  
  bar_positions <- barplot(proportions,
          beside = TRUE,
          names.arg = grades,
          col = colors,
          ylim = c(0, 1),
          main = "Observed Grade Distribution",
          ylab = "Proportion", xlab = "Grade",
          legend.text = c("Target Proportion", "Observed Proportion"))
  
  y_ticks <- seq(0, 1, by = 0.1)
  for (y in y_ticks) {
    segments(x0 = min(bar_positions) - 0.9, x1 = max(bar_positions) + 0.5, 
             y0 = y, y1 = y, col = "gray", lty = "dotted")
  }
  
  bar_positions <- barplot(proportions_with_nonrespondents,
          beside = TRUE,
          names.arg = grades,
          col = colors,
          ylim = c(0, 1),
          main = "With Nonrespondents",
          ylab = "Proportion", xlab = "Grade",
          legend.text = c("Target Proportion", "Observed Proportion"))
  
  y_ticks <- seq(0, 1, by = 0.1)
  for (y in y_ticks) {
    segments(x0 = min(bar_positions) - 0.9, x1 = max(bar_positions) + 0.5, 
             y0 = y, y1 = y, col = "gray", lty = "dotted")
  }
par(mfrow = c(1, 1), cex = 1)
```

Comparing the observed grade distribution with the target, the observed proportion of students expecting A’s is 34.1%, which exceeds the target of 20%. The observed proportion for B's is 57.1% which is much higher than the target 30%. Only 8.7% of students expect a C, which is substantially lower than the target of 40%. There were no respondents categorized as D/F students in the initial observation, compared to the target of 10%.

When non-respondents are included as D/F students (assuming these students are no longer attending and likely failing), the proportion of students expecting A’s and B’s drops slightly to 32.6% and 54.7%, respectively. These values still exceed the course's target of 20% for A's and 30% for B's, though the gap narrows. The proportion of students expecting C’s changes only slightly to 8.4%, which remains far below the 40% target. The D/F category now shows 4.2% of students, compared to the 10% target. Even with the non-respondents accounted for, the proportion of failing students remains lower than expected.

### 2.6.3 Conclusion

The observed grade distribution indicates that a larger proportion of students are expecting higher grades (A's and B's) than the target distribution set by the course. There is a significant deficit in the proportion of C’s, which suggests that students are either expecting to over perform relative to expectations, lenient grading policies, or simple course material.

The inclusion of non-respondents, under the assumption that they are failing students, slightly adjusts the distribution toward the course's targets. However, it still does not bring the observed distribution in alignment with the target proportions. Even with this adjustment, there are fewer failing students than expected, and higher grades are over-represented.

This discrepancy suggests that students’ expected performance diverge from the course's grading goals. Course content, grading policies, or other factors (such as grade inflation or differing levels of student effort) could potentially cause this misalignment.

# 3. Advanced Analysis

## 3.1 Methods

We mentioned two variables "Hate Math" and "Play if Busy" that may affect the results of the estimation of the average amount of time spent playing video games in the week prior to the survey. Now, we want to further explore these variables by comparing the average amount of time spent playing video games in the week prior to the survey between students who reported hating math and those who reported that they did not hate math as well as the mean hours between students that reported playing video games even when they are busy and those who do not. To do this, we conducted two permutation tests to find out if there exists a statistically significant difference in the means between the groups.

First, we visualized the distributions of time spent playing video games of each group and calculated the average time spent playing games within each group (represented by the red dotted line).

```{r, echo=FALSE, fig.width=3.5, fig.height=2.5}
hates_math <- video_data[video_data$math == 1,] #29
likes_math <- video_data[video_data$math == 0,] #61
play_if_busy <- video_data[video_data$busy == 1,] #17
no_play_if_busy <- video_data[video_data$busy == 0,] #63

hates_math_mean = mean(hates_math$time) #1.172414
likes_math_mean = mean(likes_math$time) #1.296721

play_if_busy_mean <- mean(play_if_busy$time) #4.705882
no_play_if_busy_mean <- mean(no_play_if_busy$time) #0.5095238

hist(hates_math$time,
     main='Hates Math',
     xlab = 'Hours Played',
     breaks=10)
abline(v = hates_math_mean, col = "red", lwd = 2, lty = 2)
hist(likes_math$time,
     main='Likes Math',
     xlab='Hours Played',
     breaks=10)
abline(v = likes_math_mean, col = "red", lwd = 2, lty = 2)
hist(play_if_busy$time,
     main='Plays if Busy',
     xlab = 'Hours Played',
     breaks=10)
abline(v = play_if_busy_mean, col = "red", lwd = 2, lty = 2)
hist(no_play_if_busy$time,
     main="Doesn't Play if Busy",
     xlab='Hours Played',
     breaks=10)
abline(v = no_play_if_busy_mean, col = "red", lwd = 2, lty = 2)
```

## 3.2 Analysis

### Hypotheses

-   **Null Hypothesis (H0):** There is no difference in the average number of hours played between students who hate math and those who do not. Any observed difference is due to random chance.

-   **Alternative Hypothesis (H1):** There is a significant difference in the average number of hours played between students who hate math and those who do not.

-   **Test Statistic**: Difference of means

-   **Significance Level**: 0.0001

-   **p-value**: The p-value for the t-test was **0.4905**, which is far above the 0.0001 significance level, which means we fail to reject the null hypothesis.

The results of the permutation test between students who reported hating math and students who reported not hating math is shown below. The dotted red line represents the observed difference between the average amount of time spent playing video games for students who reported hating math and students who reported not hating math.

```{r, echo=FALSE, fig.width=6, fig.height=4, fig.align='center'}
math_observed_difference <- hates_math_mean - likes_math_mean

n_permutations <- 10000  # Number of permutations
math_perm_diffs <- numeric(n_permutations)

for (i in 1:n_permutations) {
  shuffled_labels <- sample(video_data$math)  # Shuffle Hate_Math labels
  perm_diff <- mean(video_data$time[shuffled_labels == 1]) - mean(video_data$time[shuffled_labels == 0])
  math_perm_diffs[i] <- perm_diff
}

math_p_value <- mean(math_perm_diffs >= math_observed_difference) #0.4905

hist(math_perm_diffs, breaks = 30, main = "Permutation Distribution of Mean Differences", 
     xlab = "Difference in Means", col = "lightblue")
abline(v = math_observed_difference, col = "red", lwd = 2, lty = 2)
```

### Hypotheses

-   **Null Hypothesis (H0):** There is no difference in the average number of hours played between students who play video games when busy and those who do not. Any observed difference is due to random chance.

-   **Alternative Hypothesis (H1):** There is a significant difference in the average number of hours played between students who play video games when busy and those who do not.

-   **Test Statistic**: Difference of means

-   **Significance Level**: 0.0001

-   **p-value**: The p-value for the t-test was **0**, which is below the 0.0001 significance level, which means we reject the null hypothesis.

The results of the permutation test between students who reported hating math and students who reported not hating math is shown below. The dotted red line represents the observed difference between the average amount of time spent playing video games for students who play video games even when they are busy and students who do not.

```{r, echo=FALSE, fig.width=6, fig.height=4, fig.align='center'}
busy_observed_difference <- play_if_busy_mean - no_play_if_busy_mean

n_permutations <- 10000  # Number of permutations
busy_perm_diffs <- numeric(n_permutations)

for (i in 1:n_permutations) {
  shuffled_labels <- sample(video_data$busy)  # Shuffle Play_if_busy labels
  perm_diff <- mean(video_data$time[shuffled_labels == 1]) - mean(video_data$time[shuffled_labels == 0])
  busy_perm_diffs[i] <- perm_diff
}

busy_p_value <- mean(busy_perm_diffs >= busy_observed_difference) #0

hist(busy_perm_diffs, breaks = 30, main = "Permutation Distribution of Mean Differences", 
     xlab = "Difference in Means", col = "lightblue")
abline(v = busy_observed_difference, col = "red", lwd = 2, lty = 2)
```

## 3.3 Conclusion

In conclusion, the results of the first permutation test suggest that there is no statistically significant difference in the average hours played between students who hate math and those who do not. However, the results of the second permutation test indicate that students who play video games when they are busy tend to play significantly more hours in a week compared to students who do not play when busy, which aligns with our inference that "Play If Busy" could be a confounding variable that affects the proportion and mean estimations from Sections 2.1 and 2.2. Lifestyle factors such as time management may influence video game habits, as behaviors around time use may directly impact the amount of time allocated to gaming.

# 4. Discussion

The primary goal of this analysis was to investigate students' video game behaviors and preferences, as well as potential correlations between these behaviors and demographic factors such as gender, work, and computer ownership. Specifically, we aim to investigate the proportion of students playing video games during the week prior to the survey, the relation between reported time spend playing video games, the frequency of playing, and timing of the survey, the main reasons students like or dislike playing video games, and any noticeable differences in video game preferences and habits based on demographics. Using a survey given to students from Statistics 2, Section 1, in Fall 1994, we found that around 37% of students played video games in the week before the survey, although this estimate was imprecise due to a broad confidence interval. Additionally, students who played video games spent an average of 1.24 hours gaming, and while video games are generally popular (with 76% of students expressing enjoyment), time demands and cost were reasons for disinterest. We observed that computer ownership, but not gender or work status, was common for those who enjoyed playing video games. When analyzing the factors which may influence gaming time, we found that students who report playing video games even when busy show a significant increase in their average weekly gaming hours compared to students who do not play when busy, though students who reported hating math did not display a significant difference in their average gaming time compared to those who do not dislike math.

There are several limitations to this study that should be noted. The goal of this analysis was to investigate video game behaviors and preferences of 3000-4000 statistics students. However, since not all 3000-4000 students had an eqaul chance of being chosen to participate, the sample doesn't qualify as a simple random sample. The data was only gathered from a single statistics course section, making the sample more of a convenience sample. Therefore, the results of the analysis cannot be generalized to the population, which in this case was the 3000-4000 students enrolled in statistics courses at UC Berkeley.

Some students were asked to skip certain survey questions, specifically those who had never played video games or had a strong dislike for them. This resulted in nonrespondents for some key questions, potentially limiting the generalizability of certain conclusions. The survey was also conducted immediately after an exam, which may have right-skewed the results regarding time spent playing video games, leading to an underestimation of average playtime. Other potential influences on gaming habits were not accounted for such as socioeconomic status which could have provided more insight on the video game habits of certain groups. Despite these limitations, this analysis sheds light on students' gaming behaviors and highlights how access to technology and time management choices, playing games when busy, may influence engagement with video games.
